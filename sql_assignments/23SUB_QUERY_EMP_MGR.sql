-- 1] WAQTD SMITH'S REPORTING MANAGER NAME.
-- ENAME
-- --------
-- FORD
SELECT ENAME
FROM EMP
WHERE EMPNO IN (
	SELECT MGR
	FROM EMP
	WHERE ENAME = 'SMITH');



-- 2] WAQTD MILLER'S MANAGER'S SALARY.
-- SAL
-- -------
-- 2450
SELECT SAL
FROM EMP
WHERE EMPNO IN (
	SELECT MGR
	FROM EMP
	WHERE ENAME = 'MILLER');



-- 3] WAQTD ALLEN'S MANAGER NAME.
-- ENAME
-- -------
-- BLAKE
SELECT ENAME
FROM EMP
WHERE EMPNO IN (
	SELECT MGR
	FROM EMP
	WHERE ENAME = 'ALLEN');



-- 4] WAQTD SALARY OF ADAMS MANAGER.
-- SAL
-- -------
-- 3000
SELECT SAL
FROM EMP
WHERE EMPNO IN (
	SELECT MGR
	FROM EMP
	WHERE ENAME = 'ADAMS');



-- 5] WAQTD NAME OF ADAM'S MANAGER'S MANAGER.
-- ENAME
-- --------
-- JONES
SELECT ENAME
FROM EMP
WHERE EMPNO IN (
	SELECT MGR
	FROM EMP
	WHERE EMPNO IN (
		SELECT MGR
		FROM EMP
		WHERE ENAME = 'ADAMS')
	);



 6] WAQTD LOCATION OF SMITH'S MANAGER'S MANAGER.
-- DNAME
-- -----------
-- RESEARCH
SELECT LOC
FROM DEPT
WHERE DEPTNO IN (
	SELECT DEPTNO
	FROM EMP
	WHERE EMPNO IN (
		SELECT MGR
		FROM EMP
		WHERE EMPNO IN (
			SELECT MGR
			FROM EMP
			WHERE ENAME = 'SMITH'
		)
	)
);



-- 7] WAQTD NUMBER OF EMP'S REPORTING TO KING
-- COUNT(*)
-- --------
-- 3
SELECT COUNT(*)
FROM EMP
WHERE MGR IN (
	SELECT EMPNO
	FROM EMP
	WHERE ENAME = 'KING');



-- 8] WAQTD NAME OF EMP REPORTING TO BLAKE.
-- ENAME
-- ----------
-- ALLEN
-- WARD
-- MARTIN
-- TURNER
-- JAMES
SELECT ENAME
FROM EMP
WHERE MGR IN (
	SELECT EMPNO
	FROM EMP
	WHERE ENAME = 'BLAKE');



-- 9] WAQTD DETAILS OF AN EMP REPORTING TO JONES.
-- EMPNO ENAME JOB MGR HIREDATE SAL COMM DEPTNO
-- ------- ---------- --------- ---------- --------- ---------- ---------- ----------
-- 7788 SCOTT ANALYST 7566 19-APR-87 3000 20
-- 7902 FORD ANALYST 7566 03-DEC-81 3000 20
SELECT *
FROM EMP
WHERE MGR IN (
	SELECT EMPNO
	FROM EMP
	WHERE ENAME = 'JONES');



-- 10] WAQTD LOCATION OF MARTIN'S MANAGER.
-- DNAME
-- ------
-- SALES
SELECT LOC
FROM DEPT
WHERE DEPTNO IN (
	SELECT DEPTNO
	FROM EMP
	WHERE EMPNO IN (
		SELECT MGR
		FROM EMP
		WHERE ENAME = 'MARTIN'
	)
);



-- 11] WAQTD NUMBER OF EMP'S REPORTING TO FORD.
-- COUNT(*)
-- --------
-- 1
SELECT COUNT(*)
FROM EMP
WHERE MGR IN (
	SELECT EMPNO
	FROM EMP
	WHERE ENAME = 'FORD');



-- 12] WAQTD COMMISION OF BLAKE'S MANAGER'S MANAGER.
-- NO ROWS SELECTED
SELECT COMM
FROM EMP
WHERE EMPNO IN (
	SELECT MGR
	FROM EMP
	WHERE EMPNO IN (
		SELECT MGR
		FROM EMP
		WHERE ENAME = 'BLAKE'
	)
);



-- 13] WAQTD DEPARTMENT NAME OF CLARK'S MANAGER.
-- DNAME
-- ------------
-- ACCOUNTING
SELECT DNAME
FROM DEPT
WHERE DEPTNO IN (
	SELECT DEPTNO
	FROM EMP
	WHERE EMPNO IN (
		SELECT MGR
		FROM EMP
		WHERE ENAME = 'CLARK'
	)
);



-- 14] WAQTD LOCATION OF SCOTT'S MANAGER.
-- LOC
-- - -----------
-- DALLAS
SELECT LOC
FROM DEPT
WHERE DEPTNO IN (
	SELECT DEPTNO
	FROM EMP
	WHERE EMPNO IN (
		SELECT MGR
		FROM EMP
		WHERE ENAME = 'SCOTT'
	)
);



-- 15] WAQTD DEPTNO OF MILLER'S MANAGER.
-- DEPTNO
-- --------
-- 10
SELECT DEPTNO
FROM EMP
WHERE EMPNO IN (
	SELECT MGR
	FROM EMP
	WHERE ENAME = 'MILLER');



-- 16] WAQTD TOTAL SALARY GIVEN TO WARD'S MANAGER'S DEPTNO.
-- SUM(SAL)
-- --------
-- 9400
SELECT SUM(SAL)
FROM EMP
WHERE DEPTNO IN (
	SELECT DEPTNO
	FROM EMP
	WHERE EMPNO IN (
		SELECT MGR
		FROM EMP
		WHERE ENAME = 'WARD'
	)
);



-- 17] WAQTD MINIMUM SALARY GIVEN TO TURNER'S MANAGER'S DEPTNO.
-- MIN(SAL)
-- ---------
-- 950
SELECT MIN(SAL)
FROM EMP
WHERE DEPTNO IN (
	SELECT DEPTNO
	FROM EMP
	WHERE EMPNO IN (
		SELECT MGR
		FROM EMP
		WHERE ENAME = 'TURNER'
	)
);



-- 18] WAQTD AVERAGE SALARY GIVEN TO JONES's MANAGER'S DEPTNO.
-- AVG(SAL)
-- ----------
-- 2916.66667
SELECT AVG(SAL)
FROM EMP
WHERE DEPTNO IN (
	SELECT DEPTNO
	FROM EMP
	WHERE EMPNO IN (
		SELECT MGR
		FROM EMP
		WHERE ENAME = 'JONES'
	)
);



-- 19] WAQTD NUMBER OF EMP'S PRESENT IN JAMES MANAGER'S DEPTNO.
-- COUNT(*)
-- ----------
-- 6
SELECT COUNT(*)
FROM EMP
WHERE DEPTNO IN (
	SELECT DEPTNO
	FROM EMP
	WHERE EMPNO IN (
		SELECT MGR
		FROM EMP
		WHERE ENAME = 'JAMES'
	)
);



-- 20] WAQTD FIRST FIVE RECORDS FROM EMP TABLE.